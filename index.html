<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chúc Mừng Năm Mới 2026</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Great+Vibes&family=Playfair+Display:wght@700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        padding: 0;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        font-family: "Arial", sans-serif;
        background-color: #0a0a2a;
        cursor: crosshair;
      }

      /* 1. Khung chứa chính - Chiếm toàn màn hình */
      .cay-dao-container {
        position: relative;
        width: 100%;
        height: 100%;
      }

      /* 2. Ảnh nền - Phủ kín khung chứa */
      .cay-dao-img {
        width: 100%;
        height: 100%;
        /* Quan trọng: Giúp ảnh phủ kín màn hình mà không bị méo tỷ lệ */
        object-fit: cover;
        display: block;
        /* Nếu muốn căn giữa ảnh khi màn hình quá dài hoặc quá rộng */
        object-position: center center;
        pointer-events: none;
        user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
        -webkit-user-drag: none;
      }

      .no-drag {
        user-select: none;
        -webkit-user-drag: none;
      }
      /* --- Các style cho Lì xì và Tiêu đề vẫn giữ nguyên --- */

      /* Định dạng bao lì xì */
      .lixi {
        position: absolute;
        width: 3%;
        max-width: 35px;
        min-width: 20px;
        cursor: pointer;
        z-index: 30; /* Cao hơn background */
        transform-origin: top center;
        animation: gio-thoi 3s ease-in-out infinite alternate;
        transition:
          transform 0.3s,
          opacity 0.5s;
      }
      .lixi:hover {
        transform: scale(1.3) !important;
        z-index: 35;
      }

      .lixi img {
        width: 100%;
        height: auto;
        filter: drop-shadow(2px 2px 2px rgba(0, 0, 0, 0.5));
      }
      .lixi::before {
        content: "";
        position: absolute;
        top: -15%;
        left: 50%;
        width: 1px;
        height: 15%;
        background-color: #ffd700;
      }
      @keyframes gio-thoi {
        0% {
          transform: rotate(-6deg);
        }
        100% {
          transform: rotate(6deg);
        }
      }
      /* --- POPUP LỜI CHÚC (MODAL) --- */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 100;
        display: none; /* Ẩn mặc định */
        justify-content: center;
        align-items: center;
      }
      .modal-content {
        background: linear-gradient(135deg, #d32f2f, #b71c1c);
        padding: 30px;
        border-radius: 15px;
        border: 4px solid #ffd700;
        text-align: center;
        max-width: 400px;
        width: 80%;
        box-shadow: 0 0 20px #ffd700;
        animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative;
      }
      @keyframes popIn {
        from {
          transform: scale(0);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      .modal-text {
        color: #ffd700;
        font-family:
          "Playfair Display", serif; /* Font chữ trang trọng cho lời chúc */
        font-size: 1.8rem;
        line-height: 1.4;
        margin-bottom: 20px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      }
      .close-btn {
        background: #ffd700;
        color: #d32f2f;
        border: none;
        padding: 10px 20px;
        font-size: 1.2rem;
        font-weight: bold;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s;
      }
      .close-btn:hover {
        background: #fff;
        transform: scale(1.1);
      }
      /* Tiêu đề */
      h1 {
        position: absolute;
        top: 5%;
        width: 100%;
        text-align: center;
        margin: 0;
        z-index: 20;
        font-family: "Dancing Script", cursive;
        font-size: 5rem;
        font-weight: bold;
        background: linear-gradient(to bottom, #ffd700, #ffcc00);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        filter: drop-shadow(0 0 5px #ff0000) drop-shadow(0 0 15px #ff0000);
        animation: text-glow 2s ease-in-out infinite alternate;
        pointer-events: none; /* Để click xuyên qua chữ */
      }
      @keyframes text-glow {
        from {
          filter: drop-shadow(0 0 2px #ff0000) drop-shadow(0 0 5px #ff0000);
        }
        to {
          filter: drop-shadow(0 0 5px #ff0000) drop-shadow(0 0 20px #ffcc00);
        }
      }

      /* --- CẬP NHẬT: Style mới cho viên đạn (nhìn giống tia lửa hơn) --- */
      .projectile {
        position: absolute;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: radial-gradient(circle, #ffffff, #ffcc00, #ff5500);
        box-shadow:
          0 0 10px #ffcc00,
          0 0 20px #ff5500;
        transform-origin: center center;
        transform: scaleY(1.5);
        transition: top 1s ease-out;
        z-index: 10;
        pointer-events: none;
      }
      .particle {
        position: absolute;
        width: 5px;
        height: 5px;
        border-radius: 50%;
        box-shadow: 0 0 8px currentColor;
        pointer-events: none;
        z-index: 9;
      }
    </style>
  </head>
  <body>
    <div class="cay-dao-container" id="khung-cay">
      <h1>Chúc Mừng Năm Mới 2026</h1>
      <img
        src="caydao.png"
        alt="Cây Đào Đêm Sao"
        src="caydao.png"
        draggable="false"
        class="cay-dao-img no-drag"
      />
    </div>

    <div class="modal-overlay" id="modal">
      <div class="modal-content">
        <div class="modal-text" id="noi-dung-loi-chuc"></div>
        <button class="close-btn" onclick="dongLoiChuc()">Đóng</button>
      </div>
    </div>

    <script>
      // === 1. DANH SÁCH 36 LỜI CHÚC ===
      const danhSachLoiChuc = [
        "An khang thịnh vượng, vạn sự hanh thông, tiền vào như nước!",
        "Sức khỏe dồi dào, công việc thăng hoa, gia đình hạnh phúc viên mãn!",
        "Năm mới tràn đầy niềm vui và thành công rực rỡ!",
        "Năm mới phát tài, phát lộc, tiền bạc đầy nhà, sung túc cả năm!",
        "Mã đáo thành công!",
        "Sức khỏe vô song, dũng mãnh như ngựa chiến, đi đâu thắng đó!",
        "Cung chúc tân xuân - Vạn sự như ý.",
        "Phúc lộc thọ toàn gia, vạn sự cát tường như ý!",
        "Phát tài phát lộc - Công thành danh toại.",
        "Xuân sang cành lộc - Gia đạo bình an.",
        "Túi luôn đầy tiền - Sung sướng như tiên!",
        "Ngàn lần như ý - Vạn sự như mơ!",
        "Triệu sự bất ngờ - Tỷ lần hạnh phúc!",
        "Ăn đâu thắng đó - Ngủ sướng như tiên!",
        "Sức khỏe vô biên - Kiếm được nhiều tiền!",
        "Chúc mừng năm mới - Tấn tài tấn lộc!",
        "Mọi sự bình an - Cả nhà sung túc!",
        "Lộc biếc mai vàng - Xuân sang hạnh phúc!",
      ];
      // === 2. XỬ LÝ LÌ XÌ & POPUP ===
      const KHUNG_CAY = document.getElementById("khung-cay");
      const MODAL = document.getElementById("modal");
      const TEXT_LOI_CHUC = document.getElementById("noi-dung-loi-chuc");

      // Hàm mở lời chúc
      function moLoiChuc(loiChuc) {
        TEXT_LOI_CHUC.textContent = loiChuc;
        MODAL.style.display = "flex";
        taoPhaoGiay();
      }

      // Hàm đóng lời chúc
      function dongLoiChuc() {
        MODAL.style.display = "none";
      }

      function random(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      let daMoLixi = false;

      function taoLixi() {
        for (let i = 0; i < danhSachLoiChuc.length; i++) {
          let divLixi = document.createElement("div");
          divLixi.className = "lixi";

          let imgLixi = document.createElement("img");
          imgLixi.src = "lixi.png";
          divLixi.appendChild(imgLixi);

          // Random vị trí trên toàn màn hình
          // Vì ảnh nền rất rộng, ta cứ rải ngẫu nhiên từ 5% đến 95% màn hình
          let topPos = random(25, 65);
          let leftPos;

          if (topPos < 35) {
            leftPos = random(44, 52); // Ngọn cây: chỉ rải ở giữa
          } else if (topPos < 43) {
            leftPos = random(40, 60); // Ngọn cây: chỉ rải ở giữa
          } else {
            leftPos = random(35, 63); // Tán dưới: rải rộng ra
          }

          divLixi.style.top = topPos + "%";
          divLixi.style.left = leftPos + "%";

          divLixi.style.animationDelay = Math.random() * 2 + "s";
          divLixi.style.animationDuration = Math.random() * 2 + 2.5 + "s";

          // --- SỰ KIỆN CLICK VÀO LÌ XÌ ---
          divLixi.addEventListener("click", function (e) {
            e.stopPropagation();

            // Nếu đã mở 1 lì xì rồi → không cho mở nữa
            if (daMoLixi) return;

            daMoLixi = true; // Đánh dấu đã mở

            moLoiChuc(danhSachLoiChuc[i]);

            // Chặn click toàn bộ các lì xì khác
            document.querySelectorAll(".lixi").forEach((lixi) => {
              lixi.style.pointerEvents = "none";
            });

            // (Tuỳ chọn) Làm nổi bật lì xì đã mở
            this.style.transform = "scale(1.4)";
            this.style.zIndex = "50";
          });

          KHUNG_CAY.appendChild(divLixi);
        }
      }
      document.addEventListener("dragstart", (e) => {
        if (e.target.tagName === "DIV" || e.target.tagName === "IMG") {
          e.preventDefault();
        }
      });
      taoLixi();

      // === 3. PHÁO HOA & NỀN (Giữ nguyên logic cũ) ===
      const INTERVAL_TIME = 3000;
      const PARTICLE_COUNT = 50;
      const GRAVITY = 0.08;
      const FRICTION = 0.96;
      let mouseX = window.innerWidth / 2;
      let mouseY = window.innerHeight / 3;
      let isTabActive = true;

      document.addEventListener("mousemove", (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
      });
      document.addEventListener("visibilitychange", () => {
        isTabActive = !document.hidden;
      });

      function launchFirework() {
        const projectile = document.createElement("div");
        projectile.className = "projectile";
        const startX = mouseX;
        const startY = window.innerHeight + 20;
        projectile.style.left = `${startX - 4}px`;
        projectile.style.top = `${startY}px`;
        document.body.appendChild(projectile);

        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            projectile.style.top = `${mouseY}px`;
          });
        });

        projectile.addEventListener("transitionend", function (e) {
          if (e.propertyName !== "top") return;
          explode(startX, mouseY);
          projectile.remove();
        });
      }

      function explode(x, y) {
        const colors = [
          "#ff0000",
          "#00ff00",
          "#4287f5",
          "#ffff00",
          "#00ffff",
          "#ff00ff",
          "#ffffff",
          // "#ffaa00",
          // "#ff5e00",
        ];
        for (let i = 0; i < PARTICLE_COUNT; i++) {
          createParticle(x, y, colors);
        }
      }

      // Tách hàm tạo hạt để dùng chung cho cả pháo hoa và lì xì
      function createParticle(x, y, colors) {
        const particle = document.createElement("div");
        particle.className = "particle";
        const color = colors[Math.floor(Math.random() * colors.length)];
        particle.style.backgroundColor = color;
        particle.style.color = color;
        document.body.appendChild(particle);

        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 7 + 3;
        const velocity = {
          x: Math.cos(angle) * speed,
          y: Math.sin(angle) * speed,
        };
        let opacity = 1;
        let currentX = x;
        let currentY = y;

        function animate() {
          velocity.x *= FRICTION;
          velocity.y *= FRICTION;
          velocity.y += GRAVITY;
          currentX += velocity.x;
          currentY += velocity.y;
          opacity -= 0.015;
          particle.style.left = `${currentX}px`;
          particle.style.top = `${currentY}px`;
          particle.style.opacity = opacity;
          if (opacity > 0) requestAnimationFrame(animate);
          else particle.remove();
        }
        animate();
      }

      // Hàm nổ pháo giấy ở giữa màn hình khi mở lì xì
      function taoPhaoGiay() {
        const colors = ["gold", "red", "white"];
        const centerX = window.innerWidth / 2;
        const centerY = window.innerHeight / 2;
        for (let i = 0; i < 100; i++) {
          createParticle(centerX, centerY, colors);
        }
      }

      setInterval(() => {
        if (isTabActive && MODAL.style.display !== "flex") launchFirework();
      }, INTERVAL_TIME);
      document.addEventListener("click", (e) => {
        if (e.target.closest(".lixi") || e.target.closest(".modal-content"))
          return;
        mouseX = e.clientX;
        mouseY = e.clientY;
        launchFirework();
      });
    </script>
  </body>
</html>
